# Option A: 迷路実験版

## タイトル案

**日本語**: 「geDIG: 自由エネルギー原理に基づく知識グラフ自律更新の統一ゲージ」

**英語**: "geDIG: A Unified Gauge for Autonomous Knowledge Graph Updates Based on Free Energy Principle"

---

## 想定セッション

- 知識表現・推論
- エージェント・自律システム
- 認知アーキテクチャ

---

## アブストラクト案（200字程度）

動的に成長する知識グラフにおいて「いつ新しい知識を受け入れるか」を判断する規範が欠落している。本研究では、自由エネルギー原理（FEP）と最小記述長（MDL）を橋渡しする統一ゲージgeDIG（F = ΔEPC_norm − λ(ΔH_norm + γΔSP_rel)）を提案する。部分観測迷路環境において、0-hopの曖昧検知（AG）とmulti-hopの短絡確認（DG）による二段ゲートが、探索と統合を同時に制御することを示した。15×15では成功率0.98、25×25では0.75を維持し、51×51ではステップ上限の影響で成功率が低下した。geDIGは知識の選択的統合のための実用的な「When基準」を与える。

---

## 4ページ構成案

### 1. はじめに（0.5ページ）

**問題提起**:
- 動的知識グラフの「When」問題
  - 何を取るか（What）は得意だが、いつ受け入れるか（When）の基準がない
  - 知識汚染、冗長化、応答遅延のトレードオフが場当たり化

**本研究の位置づけ**:
- 言語要素を排した「純粋な世界モデル実験」
- geDIGの原理検証としての迷路PoC

**貢献**:
1. FEP-MDLを橋渡しする統一ゲージgeDIGの提案
2. AG/DG二段ゲートによる探索/統合の同時制御
3. 部分観測迷路での有効性実証

---

### 2. 提案手法: geDIG（1ページ）

#### 2.1 統一ゲージの定義

```
F = ΔEPC_norm − λ(ΔH_norm + γ·ΔSP_rel)
```

| 項 | 意味 | 符号規約 |
|----|------|----------|
| ΔEPC_norm | 正規化編集経路コスト | 編集が多い→大 |
| ΔH_norm | エントロピー差 | 秩序化→負 |
| ΔSP_rel | 相対最短路ゲイン | 短縮→正 |

**解釈**: F が小さいほど「構造コストが低く、情報整理が進んだ統合」

#### 2.2 二段ゲート（AG/DG）

**AG（Attention Gate）**: 0-hop評価
- g₀ > θ_AG → 曖昧さ検知 → 探索深化
- FEP的「予測誤差」に対応

**DG（Decision Gate）**: Multi-hop評価
- g_min < θ_DG → 短絡確認 → 統合確定
- MDL的「記述長削減」に対応

#### 2.3 理論的背景

- FEP-MDLブリッジの操作的対応
- 覚醒（オンライン）/睡眠（オフライン）の二相アーキテクチャ

**図1**: 二段ゲートの制御フロー図

---

### 3. 実験: 部分観測迷路（1.5ページ）

#### 3.1 実験設定

**環境**:
- 迷路サイズ: 15×15, 25×25, 51×51
- 部分観測: エージェントは現在位置の周囲のみ観測可能
- エピソード記憶: 過去の探索をグラフとして保持

**パラメータ**:
- λ = 1.0, γ = 1.0（論文プリセット）
- θ_AG, θ_DG: 分位ベースで適応設定

**評価指標**:
- 成功率（ゴール到達）
- 平均ステップ数
- 平均エッジ数（構造の疎さの指標）

#### 3.2 結果

**表1: 迷路サイズ別の結果**

| サイズ | シード数 | 成功率 | 平均ステップ | エッジ圧縮率 |
|--------|----------|--------|--------------|--------------|
| 15×15  | 100      | 0.98   | 92.8         | 69.0         |
| 25×25  | 60       | 0.75   | 315.6        | 284.5        |
| 51×51  | 13       | 0.46   | 793.2        | 1541.0       |

**図2**: 25×25迷路でのg₀/g_min時系列とAG/DG発火タイミング

**図3**: グラフ成長の可視化（スナップショット）

#### 3.3 アブレーション

現時点では未実施。AGのみ/DGのみ/ランダムの比較は今後の追加検証とする。

---

### 4. 考察（0.5ページ）

#### 4.1 なぜ迷路が重要か

- 言語ノイズを排除した純粋な検証
- AG/DGの意味が直感的（行き止まり=短絡形成）
- RAGへの移植可能性の示唆

#### 4.2 限界と今後の課題

- 51×51での成功率低下（計算量制約）
- Phase 2（オフライン再配線）は未実装
- RAG、Transformerへの展開

---

### 5. 結論（0.3ページ）

- geDIGが知識グラフの「When」問題に対する統一基準を提供
- 部分観測迷路で有効性を実証
- 今後: RAG、Transformer、継続学習への応用

---

### 参考文献（0.2ページ）

- Friston (2010): Free Energy Principle
- Grünwald (2007): MDL
- 関連するグラフRAG論文
- （自己引用: arxiv版があれば）

---

## 図表リスト

1. **図1**: AG/DG二段ゲートの制御フロー
2. **図2**: g₀/g_min時系列（25×25迷路）
3. **図3**: グラフ成長スナップショット
4. **表1**: 迷路サイズ別結果
5. **表2**: アブレーション結果

---

## 強み

- 理論と実験が綺麗に対応
- 可視化が直感的
- 「原理検証」として完結

## 弱み

- 実用インパクトが見えにくい
- 「迷路で何がうれしいの？」への回答が必要
- Transformerほどキャッチーではない

---

## 想定Q&A

**Q: 迷路を解いて何がうれしいの？**
A: 言語を排除してgeDIGの原理を純粋に検証するため。RAGやTransformerへの応用の前段階。

**Q: 51×51で成功率が下がるのはなぜ？**
A: 計算量制約によるmulti-hop評価の打ち切り。Phase 2（オフライン再配線）で改善予定。

**Q: 既存の迷路解法（A*など）と何が違う？**
A: A*は「最短経路」を求める。geDIGは「何を記憶するか」を判断する。目的が異なる。

---

## レポート（現状版）

### 1. 背景と目的

動的に成長する知識グラフでは、どの知識を取り込むか（What）だけでなく、いつ取り込むか（When）が性能と安定性を左右する。特にRAGのような検索ベース構成では、統合のタイミングが曖昧なまま実装に依存し、冗長化や誤統合を引き起こしやすい。本レポートでは、FEPとMDLを操作的に橋渡しする統一ゲージgeDIGを用い、When判断をスカラーで定義できることを、部分観測迷路で検証した結果をまとめる。

### 2. 提案手法

geDIGは、編集経路コストと情報利得をトレードオフする単一スカラーとして定義する。

```
F = ΔEPC_norm − λ(ΔH_norm + γΔSP_rel)
```

AG（Attention Gate）は0-hopで曖昧さを検出し探索を促すゲートであり、DG（Decision Gate）はmulti-hopでショートカット効果を確認し統合を確定するゲートである。AG/DGを二段で用いることで、探索と統合の切り替えを明示的に制御する。

### 3. 実験設定

- 迷路サイズ: 15×15, 25×25, 51×51
- 部分観測: 現在位置周辺のみ観測
- 知識表現: クエリノードをハブとする動的グラフ（query-hub）
- 主要パラメータ: λ=1.0, γ=1.0, θ_AG=0.4, θ_DG=0.0, max_hops=10
- 最大ステップ: 15×15で250, 25×25で500, 51×51で1500
- シード数: 15×15で100, 25×25で60, 51×51で13

評価指標は成功率、平均ステップ数、平均エッジ数とした。

### 4. 結果

| サイズ | シード数 | 成功率 | 平均ステップ | 平均エッジ数 |
|--------|----------|--------|--------------|--------------|
| 15×15  | 100      | 0.98   | 92.8         | 69.0         |
| 25×25  | 60       | 0.75   | 315.6        | 284.5        |
| 51×51  | 13       | 0.46   | 793.2        | 1541.0       |

15×15と25×25では高い成功率を維持しながら、エッジ数が迷路全域に拡張せず局所的な構造で収束する傾向が見られた。51×51ではステップ上限の影響が大きく、探索途中で打ち切られるケースが増え、成功率が低下した。

### 5. 可視化の要点

- **g0/gmin時系列**: AGが探索フェーズで頻繁に発火し、DGがショートカット候補の確定局面で発火する様子が確認できる。
- **グラフ成長スナップショット**: 迷路全体を埋め尽くすのではなく、ゴール到達に必要な領域を優先して構造化する傾向がある。

### 6. 考察

geDIGは「統合すべきか」を単一ゲージで判断できるため、探索（曖昧さの解消）と統合（構造の圧縮）の切り替えが明確になる。迷路は言語ノイズを排除できるため、geDIGの基礎原理を検証するPoCとして適している。一方、51×51で成功率が落ちる点は、計算量制約によるmulti-hop評価の打ち切りが主因であり、探索予算を増やせば改善が見込まれる。

### 7. 限界と今後

- 51×51の探索予算が不足しているため、より長いステップ上限での再評価が必要。
- AGのみ/DGのみなどのアブレーションは未実施。
- Phase 2（オフライン再配線）を実装していないため、構造最適化の上限が未検証。

### 8. まとめ

geDIGは動的知識グラフのWhen判断を与える統一ゲージとして機能し、部分観測迷路において探索と統合の同時制御が可能であることを示した。今後は、より大規模な迷路・アブレーション・Phase 2の検証を進め、RAGなど実タスクへの移植性を評価する。
