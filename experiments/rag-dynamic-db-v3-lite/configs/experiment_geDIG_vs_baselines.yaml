experiment:
  name: rag_v3_lite
  output_dir: results
  seed: 42

dataset:
  path: data/sample_queries.jsonl
  max_queries: 25          # デフォルトで 25 件。None で全件。

embedding:
  model: sentence-transformers/all-MiniLM-L6-v2  # 未インストールの場合はランダム
  normalize: true
  cache_dir: null

retrieval:
  top_k: 4
  bm25_weight: 0.5
  embedding_weight: 0.5
  expansion_hops: 1

gedig:
  lambda: 0.6
  use_multihop: true
  max_hops: 3
  decay_factor: 0.7
  sp_beta: 0.2
  sp_scope_mode: auto      # auto | union
  sp_hop_expand: 0         # 評価範囲を (hop+expand) に拡張
  sp_eval_mode: connected  # connected | fixed_before_pairs
  sp_pair_samples: 400     # SPペアのサンプリング数（0で全対）
  sp_use_sampling: true    # Trueならサンプリング、Falseなら全対
  theta_ag: 8.0            # g0 高値に合わせて再調整
  theta_dg: 0.6            # gmin が 0.6 を下回るとDG
  ig_mode: raw             # raw | z | norm
  spike_mode: and          # threshold | and | or
  entropy_tau: 1.0         # geDIG ΔH の温度（環境変数でも上書き可）

psz:
  acceptance_threshold: 0.6
  fmr_threshold: 0.02
  latency_p50_threshold_ms: 200

baselines:
  - name: static_rag
    type: static
    description: "一次 retrieval のみで回答"
  - name: frequency
    type: frequency
    description: "過去の参照頻度を優先するヒューリスティック"
  - name: cosine_topk
    type: cosine
    description: "埋め込み類似度のみで上位を採用"
  - name: gedig_ag_dg
    type: gedig
    description: "geDIG + 二段ゲート (AG/DG) 制御"

logging:
  save_step_logs: true
  save_memory_snapshots: false
  snapshot_interval: 10
